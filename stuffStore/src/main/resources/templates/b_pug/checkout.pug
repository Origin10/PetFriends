//output:../checkout.html, doctype:strict
doctype html
html(lang='en', xmlns:th='http://www.w3.org/1000/xhtml')
  head(th:replace='common/header :: common-header')/
  body
    div(th:replace='common/header :: navbar')/
    .container
      .row(style='margin-bottom: -100px;')
        .col-xs-8
          h2.section-headline
            span User Account
        .col-xs-4
          img.img-responsive(src='/image/logo.png')
      hr(style='position: absolute; width: 100%; height: 6px; background-color: #333; z-index: -1; margin-top: -80px;')
      img.img-responsive(src='/image/wood.png', style='margin-top: -75px;')
      .row(style='margin-top: 10px;')
        form(th:action='@{/checkout}', method='post')
          // Left Panel
          .col-xs-4
            .panel.panel-default
              .panel-body
                button.btn.btn-warning.btn-block(type='submit')
                  | Place
                  | your order
                p(style='font-size: smaller;')
                  | By placing your order, you agree to Le's Bookstore 
                  a(href='#') privacy
                  | 								notice and 
                  a(href='#') conditions
                  |  of use.
                hr
                h3 Order Summary
                .row
                  .col-xs-7.text-left Total before tax:
                  .col-xs-5.text-right
                    | $
                    span(th:text='${shoppingCart.grandTotal}')
                .row
                  .col-xs-7.text-left Estimated tax:
                  .col-xs-5.text-right
                    | $
                    span(th:with='tax=${shoppingCart.grandTotal*0.06}', th:text='${#numbers.formatDecimal(tax, 0 ,2)}')
                .row
                  .col-xs-7.text-left
                    h3(style='color: darkred;')
                      strong Order Total: 
                  .col-xs-5.text-right
                    h3
                      strong(style='color: darkred;')
                        | $
                        span(th:with='total=${shoppingCart.grandTotal+shoppingCart.grandTotal*0.06}', th:text='${#numbers.formatDecimal(total, 0 ,2)}')
                .panel-footer
                  | Shipping and handling haven't
                  | applied.
          // Checkout Info
          .col-xs-8
            div(th:if='${missingRequiredField}')
              h5.alert.alert-warning
                | There are some fields
                | missing. Field with * is required.
            #accordion.panel-group
              // 1. Shipping Address
              .panel.panel-default
                .panel-heading
                  h4.panel-title
                    a(data-toggle='collapse', data-parent='#accordion', href='#shippingInfo')  1. Shipping Address 
                #shippingInfo.panel-collapse.collapse(th:classappend="${classActiveShipping}? 'in'")
                  .panel-body
                    table.table(th:if='${not emptyShippingList}')
                      thead
                        tr
                          th Available Shipping Address
                          th Operations
                      tbody
                        tr(th:each='userShipping : ${userShippingList}')
                          td(th:text="${userShipping.userShippingStreet1}+' '+${userShipping.userShippingStreet2}+', '+${userShipping.userShippingCity}\
                          +', '+${userShipping.userShippingState}")
                          td
                            a(th:href='@{/setShippingAddress(userShippingId=${userShipping.id})}')
                              | use
                              | this address
                    .form-group
                      label(for='shippingName') * Name
                      input#shippingName.form-control(type='text', placeholder='Receiver Name', name='shippingAddressName', th:value='${shippingAddress.shippingAddressName}')
                    .form-group
                      label(for='shippingStreet') * Street Address
                      input#shippingStreet.form-control(type='text', placeholder='Street Address 1', name='shippingAddressStreet1', th:value='${shippingAddress.shippingAddressStreet1}')
                    .form-group
                      input.form-control(type='text', placeholder='Street Address 2', name='shippingAddressStreet2', th:value='${shippingAddress.shippingAddressStreet2}')
                    .row
                      .col-xs-4
                        .form-group
                          label(for='shippingCity') * City
                          input#shippingCity.form-control(type='text', placeholder='Shipping City', th:name='shippingAddressCity', required='required', th:value='${shippingAddress.shippingAddressCity}')
                      .col-xs-4
                        .form-group
                          label(for='shippingState') * State
                          select#shippingState.form-control(th:name='shippingAddressState', th:value='${shippingAddress.shippingAddressState}', required='required')
                            option(value='', disabled='disabled')
                              | Please select
                              | an option
                            option(th:each='state : ${stateList}', th:text='${state}', th:selected='(${shippingAddress.shippingAddressState}==${state})')
                      .col-xs-4
                        .form-group
                          label(for='shippingZipcode') * Zipcode
                          input#shippingZipcode.form-control(type='text', placeholder='Shipping Zipcode', th:name='shippingAddressZipcode', required='required', th:value='${shippingAddress.shippingAddressZipcode}')
                    a.btn.btn-warning.pull-right(data-toggle='collapse', data-parent='#accordion', href='#paymentInfo') Next
              // Payment Information
              .panel.panel-default
                .panel-heading
                  h4.panel-title
                    a(data-toggle='collapse', data-parent='#accordion', href='#paymentInfo')  2. Payment Information 
                #paymentInfo.panel-collapse.collapse(th:classappend="${classActivePayment}? 'in'")
                  .panel-body
                    table.table(th:if='${not emptyPaymentList}')
                      thead
                        tr
                          th Available Credit Card
                          th Operations
                      tbody
                        tr(th:each='userPayment : ${userPaymentList}')
                          td(th:text='${userPayment.cardName}')
                          td
                            a(th:href='@{/setPaymentMethod(userPaymentId=${userPayment.id})}')
                              | use
                              | this payment
                    // Credit Card Information
                    .row
                      .col-xs-12
                        img.img-responsive(th:src='@{/image/creditcard.png}')
                        br
                        .form-group
                          label(for='cardType') * Select Card Type: 
                          select#cardType.form-control(name='type', th:value='${payment.type}')
                            option(value='visa') Visa
                            option(value='mastercard') Mastercard
                            option(value='discover') Discover
                            option(value='amex') American Express
                        .form-group
                          label(for='cardHolder') * Card Holder Name:
                          input#cardHolder.form-control(type='text', required='required', placeholder='Card Holder Name', th:name='holderName', th:value='${payment.holderName}')
                        .form-group
                          label(for='cardNumber') * Card Number:
                          .input-group
                            input#cardNumber.form-control(type='tel', required='required', placeholder='Valid Card Number', th:name='cardNumber', th:value='${payment.cardNumber}')
                            span.input-group-addon
                              i.fa.fa-credit-card(aria-hidden='true')
                    .row
                      .col-xs-7
                        .form-group
                          label * Expiration Date
                          .row
                            .col-xs-6
                              select.form-control(name='expiryMonth', required='required', th:value='${payment.expiryMonth}')
                                option(disabled='disabled') -- Month --
                                option(value='01') Jan (01)
                                option(value='02') Feb (02)
                                option(value='03') Mar (03)
                                option(value='04') Apr (04)
                                option(value='05') May (05)
                                option(value='06') June (06)
                                option(value='07') July (07)
                                option(value='08') Aug (08)
                                option(value='09') Sep (09)
                                option(value='10') Oct (10)
                                option(value='11') Nov (11)
                                option(value='12') Dec (12)
                            .col-xs-6
                              select.form-control(name='expiryYear', th:value='${payment.expiryYear}')
                                option(disabled='disabled') -- Year --
                                option(value='2017') 2017
                                option(value='2018') 2018
                                option(value='19') 2019
                                option(value='20') 2020
                                option(value='21') 2021
                                option(value='22') 2022
                                option(value='23') 2023
                                option(value='23') 2024
                                option(value='23') 2025
                                option(value='23') 2026
                                option(value='23') 2027
                                option(value='23') 2028
                                option(value='23') 2029
                      .col-xs-5
                        .form-group
                          label(for='cardCVC') CV Code
                          input#cardCVC.form-control(type='tel', name='cvc', placeholder='CVC', th:name='cvc', th:value='${payment.cvc}')
                    // Billing Address
                    .checkbox
                      label
                        input#theSameAsShippingAddress(type='checkbox', name='billingSameAsShipping', value='true')
                        | 											The same as shipping address
                    .form-group
                      label(for='billingName') * Name
                      input#billingName.form-control.billingAddress(type='text', placeholder='Receiver Name', th:name='billingAddressName', required='required', th:value='${billingAddress.billingAddressName}')
                    .form-group
                      label(for='billingAddress') * Street Address
                      input#billingAddress.form-control.billingAddress(type='text', placeholder='Street Address 1', th:name='billingAddressStreet1', required='required', th:value='${billingAddress.billingAddressStreet1}')
                      input#billingAddress.form-control.billingAddress(type='text', placeholder='Street Address 2', th:name='billingAddressStreet2', th:value='${billingAddress.billingAddressStreet2}')
                    .row
                      .col-xs-4
                        .form-group
                          label(for='billingCity') * City
                          input#billingCity.form-control.billingAddress(type='text', placeholder='Billing city', th:name='billingAddressCity', required='required', th:value='${billingAddress.billingAddressCity}')
                      .col-xs-4
                        .form-group
                          label(for='billingState') * State
                          select#billingState.form-control.billingAddress(th:name='billingAddressState', th:value='${billingAddress.billingAddressState}', required='required')
                            option(value='', disabled='disabled')
                              | Please select
                              | an option
                            option(th:each='state : ${stateList}', th:text='${state}', th:selected='(${billingAddress.billingAddressState}==${state})')
                      .col-xs-4
                        .form-group
                          label(for='billingZipcode') * Zipcode
                          input#billingZipcode.form-control.billingAddress(type='text', placeholder='Billing Zipcode', th:name='billingAddressZipcode', required='required', th:value='${billingAddress.billingAddressZipcode}')
                    a.btn.btn-warning.pull-right(data-toggle='collapse', data-parent='#accordion', href='#reviewItems') Next
              // 3. Review Items and Shipping
              .panel.panel-default
                .panel-heading
                  h4.panel-title
                    a(data-toggle='collapse', data-parent='#accordion', href='#reviewItems')  3. Review Items and Shipping 
                #reviewItems.panel-collapse.collapse
                  .panel-body
                    h4 Choose your shipping method:
                    .radio
                      label
                        input(type='radio', name='shippingMethod', value='groundShipping', checked='checked')
                        |  Ground Shipping
                    .radio
                      label
                        input(type='radio', name='shippingMethod', value='premiumShipping')
                        |  Premium Shipping
                    .row
                      .col-xs-8
                        h4 Products
                      .col-xs-2
                        h4 Price
                      .col-xs-2
                        h4 Qty
                    // display products in cart
                    .row(th:each='cartItem : ${cartItemList}')
                      hr
                      .col-xs-2
                        a(th:href='@{/bookDetail(id=${cartItem.book.id})}')
                          img.img-responsive.shelf-book(th:src="#{adminPath}+@{/image/book/}+${cartItem.book.id}+'.png'", style='width: 70px;')
                      .col-xs-6
                        div(style='margin-left: 50px;')
                          a(th:href='@{/bookDetail?id=}+${cartItem.book.id}')
                            h4(th:text='${cartItem.book.title}')
                          p(th:if='${cartItem.book.inStockNumber>10}', style='color: green;') In Stock
                          p(th:if='${cartItem.book.inStockNumber<10 and cartItem.book.inStockNumber>0}', style='color: green;')
                            | Only 
                            span(th:text='${cartItem.book.inStockNumber}')
                            | 														In Stock
                          p(th:if='${cartItem.book.inStockNumber==0}', style='color: darkred;') Product Unavailable
                          a(th:href='@{/shoppingCart/removeItem?id=}+${cartItem.id}') delete
                      .col-xs-2
                        h5(style='color: #db3208; font-size: large;')
                          | $
                          span(th:text='${cartItem.book.ourPrice}', th:style="${cartItem.book.inStockNumber}==0? 'text-decoration: line-through' : ''")
                      .col-xs-2
                        h5(style='font-size: large;', th:text='${cartItem.qty}')
                    hr
                    h4.col-xs-12.text-right
                      strong(style='font-size: large;')
                        | Order Total (
                        span(th:text='${#lists.size(cartItemList)}')
                        |  items):
                      span(style='color: #db3208; font-szie: large;')
                        | $
                        span(th:text='${shoppingCart.grandTotal}')
                    br
                    br
                    button.btn.btn-warning.btn-block(type='submit')
                      | Place
                      | your order
                    p(style='font-size: smaller;')
                      | By placing your order, you agree to Le's Bookstore 
                      a(href='#') privacy
                      | 										notice and 
                      a(href='#') conditions
                      |  of use.
    // end of container
    div(th:replace='common/header :: footer')/
    div(th:replace='common/header :: body-bottom-scripts')/
